{
    "title": "@078: Arm\u00e1rio -  Either, Map",
    "description": "<!DOCTYPE html>\n<html xmlns=\"http://www.w3.org/1999/xhtml\" lang=\"\" xml:lang=\"\">\n<head>\n  <meta charset=\"utf-8\" />\n  <meta name=\"generator\" content=\"pandoc\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, user-scalable=yes\" />\n  <title>@078: Arm\u00e1rio - Either, Map</title>\n  <style>\n    code{white-space: pre-wrap;}\n    span.smallcaps{font-variant: small-caps;}\n    div.columns{display: flex; gap: min(4vw, 1.5em);}\n    div.column{flex: auto; overflow-x: auto;}\n    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}\n    /* The extra [class] is a hack that increases specificity enough to\n       override a similar rule in reveal.js */\n    ul.task-list[class]{list-style: none;}\n    ul.task-list li input[type=\"checkbox\"] {\n      font-size: inherit;\n      width: 0.8em;\n      margin: 0 0.8em 0.2em -1.6em;\n      vertical-align: middle;\n    }\n    /* CSS for syntax highlighting */\n    html { -webkit-text-size-adjust: 100%; }\n    pre > code.sourceCode { white-space: pre; position: relative; }\n    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }\n    pre > code.sourceCode > span:empty { height: 1.2em; }\n    .sourceCode { overflow: visible; }\n    code.sourceCode > span { color: inherit; text-decoration: inherit; }\n    div.sourceCode { margin: 1em 0; }\n    pre.sourceCode { margin: 0; }\n    @media screen {\n    div.sourceCode { overflow: auto; }\n    }\n    @media print {\n    pre > code.sourceCode { white-space: pre-wrap; }\n    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }\n    }\n    pre.numberSource code\n      { counter-reset: source-line 0; }\n    pre.numberSource code > span\n      { position: relative; left: -4em; counter-increment: source-line; }\n    pre.numberSource code > span > a:first-child::before\n      { content: counter(source-line);\n        position: relative; left: -1em; text-align: right; vertical-align: baseline;\n        border: none; display: inline-block;\n        -webkit-touch-callout: none; -webkit-user-select: none;\n        -khtml-user-select: none; -moz-user-select: none;\n        -ms-user-select: none; user-select: none;\n        padding: 0 4px; width: 4em;\n        color: #aaaaaa;\n      }\n    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }\n    div.sourceCode\n      {   }\n    @media screen {\n    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }\n    }\n    code span.al { color: #ff0000; font-weight: bold; } /* Alert */\n    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */\n    code span.at { color: #7d9029; } /* Attribute */\n    code span.bn { color: #40a070; } /* BaseN */\n    code span.bu { color: #008000; } /* BuiltIn */\n    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */\n    code span.ch { color: #4070a0; } /* Char */\n    code span.cn { color: #880000; } /* Constant */\n    code span.co { color: #60a0b0; font-style: italic; } /* Comment */\n    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */\n    code span.do { color: #ba2121; font-style: italic; } /* Documentation */\n    code span.dt { color: #902000; } /* DataType */\n    code span.dv { color: #40a070; } /* DecVal */\n    code span.er { color: #ff0000; font-weight: bold; } /* Error */\n    code span.ex { } /* Extension */\n    code span.fl { color: #40a070; } /* Float */\n    code span.fu { color: #06287e; } /* Function */\n    code span.im { color: #008000; font-weight: bold; } /* Import */\n    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */\n    code span.kw { color: #007020; font-weight: bold; } /* Keyword */\n    code span.op { color: #666666; } /* Operator */\n    code span.ot { color: #007020; } /* Other */\n    code span.pp { color: #bc7a00; } /* Preprocessor */\n    code span.sc { color: #4070a0; } /* SpecialChar */\n    code span.ss { color: #bb6688; } /* SpecialString */\n    code span.st { color: #4070a0; } /* String */\n    code span.va { color: #19177c; } /* Variable */\n    code span.vs { color: #4070a0; } /* VerbatimString */\n    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */\n  </style>\n</head>\n<body>\n<h1 id=\"arm\u00e1rio---either-map\">Arm\u00e1rio - Either, Map</h1>\n<p>Uma escola de ensino m\u00e9dio tem arm\u00e1rios para que os estudantes tenham\nalgum lugar para p\u00f4r os seus p\u00f4steres do Guns\u2019n\u2019Roses. Cada arm\u00e1rio tem\numa combina\u00e7\u00e3o de c\u00f3digo. Quando um estudante quer um novo arm\u00e1rio, ele\nir\u00e1 falar para o supervisor dos arm\u00e1rios o n\u00famero do arm\u00e1rio que ele\nquer e ent\u00e3o o supervisor lhe dar\u00e1 um c\u00f3digo. Entretanto, se algu\u00e9m j\u00e1\nestiver usando o arm\u00e1rio, ele n\u00e3o poder\u00e1 dizer o c\u00f3digo do arm\u00e1rio e\nter\u00e1 que pegar um diferente. N\u00f3s iremos usar um mapa a partir de\nData.Map para representar os arm\u00e1rios. Ele vai mapear a partir dos\nn\u00fameros dos arm\u00e1rios para um par de arm\u00e1rios que est\u00e3o em uso ou n\u00e3o e\nos c\u00f3digos dos arm\u00e1rios.</p>\n<p>Voc\u00ea pode conferir a descri\u00e7\u00e3o completa do problema base em <a\nhref=\"http://haskell.tailorfontela.com.br/making-our-own-types-and-typeclasses#type-synonyms\">LINK</a>.</p>\n<p>Utilize o c\u00f3digo abaixo <a\nhref=\"https://github.com/senapk/funcional_arcade/blob/master/base/078/student.hs\">student.hs</a>.\nVoc\u00ea deve implentar onde existem os \u2026 J\u00e1 existem alguns casos de teste\nna main, como tamb\u00e9m a sa\u00edda esperada.</p>\n<h2 id=\"shell\">Shell</h2>\n<div class=\"sourceCode\" id=\"cb1\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb1-1\"><a href=\"#cb1-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case init</span></span>\n<span id=\"cb1-2\"><a href=\"#cb1-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 100 banana</span>\n<span id=\"cb1-3\"><a href=\"#cb1-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 101 goiaba</span>\n<span id=\"cb1-4\"><a href=\"#cb1-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 102 sapoti</span>\n<span id=\"cb1-5\"><a href=\"#cb1-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb1-6\"><a href=\"#cb1-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Free banana</span>\n<span id=\"cb1-7\"><a href=\"#cb1-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Free goiaba</span>\n<span id=\"cb1-8\"><a href=\"#cb1-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Free sapoti</span>\n<span id=\"cb1-9\"><a href=\"#cb1-9\" aria-hidden=\"true\" tabindex=\"-1\"></a></span>\n<span id=\"cb1-10\"><a href=\"#cb1-10\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case criar ja existindo</span></span>\n<span id=\"cb1-11\"><a href=\"#cb1-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 101 murici</span>\n<span id=\"cb1-12\"><a href=\"#cb1-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> locker 101 ja existe</span>\n<span id=\"cb1-13\"><a href=\"#cb1-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb1-14\"><a href=\"#cb1-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Free banana</span>\n<span id=\"cb1-15\"><a href=\"#cb1-15\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Free goiaba</span>\n<span id=\"cb1-16\"><a href=\"#cb1-16\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Free sapoti</span>\n<span id=\"cb1-17\"><a href=\"#cb1-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$end</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb2\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb2-1\"><a href=\"#cb2-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case init</span></span>\n<span id=\"cb2-2\"><a href=\"#cb2-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 100 banana</span>\n<span id=\"cb2-3\"><a href=\"#cb2-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 101 goiaba</span>\n<span id=\"cb2-4\"><a href=\"#cb2-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 102 sapoti</span>\n<span id=\"cb2-5\"><a href=\"#cb2-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 101</span>\n<span id=\"cb2-6\"><a href=\"#cb2-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">seu</span> codigo de acesso eh goiaba</span>\n<span id=\"cb2-7\"><a href=\"#cb2-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 102</span>\n<span id=\"cb2-8\"><a href=\"#cb2-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">seu</span> codigo de acesso eh sapoti</span>\n<span id=\"cb2-9\"><a href=\"#cb2-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb2-10\"><a href=\"#cb2-10\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Free banana</span>\n<span id=\"cb2-11\"><a href=\"#cb2-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Used goiaba</span>\n<span id=\"cb2-12\"><a href=\"#cb2-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Used sapoti</span>\n<span id=\"cb2-13\"><a href=\"#cb2-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case erros de alocacao</span></span>\n<span id=\"cb2-14\"><a href=\"#cb2-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 104</span>\n<span id=\"cb2-15\"><a href=\"#cb2-15\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> locker 104 nao existe</span>\n<span id=\"cb2-16\"><a href=\"#cb2-16\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 101</span>\n<span id=\"cb2-17\"><a href=\"#cb2-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> locker 101 ja esta em uso</span>\n<span id=\"cb2-18\"><a href=\"#cb2-18\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb2-19\"><a href=\"#cb2-19\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Free banana</span>\n<span id=\"cb2-20\"><a href=\"#cb2-20\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Used goiaba</span>\n<span id=\"cb2-21\"><a href=\"#cb2-21\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Used sapoti</span>\n<span id=\"cb2-22\"><a href=\"#cb2-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$end</span></span></code></pre></div>\n<div class=\"sourceCode\" id=\"cb3\"><pre class=\"sourceCode sh\"><code class=\"sourceCode bash\"><span id=\"cb3-1\"><a href=\"#cb3-1\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case init</span></span>\n<span id=\"cb3-2\"><a href=\"#cb3-2\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 100 banana</span>\n<span id=\"cb3-3\"><a href=\"#cb3-3\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 101 goiaba</span>\n<span id=\"cb3-4\"><a href=\"#cb3-4\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$create</span> 102 sapoti</span>\n<span id=\"cb3-5\"><a href=\"#cb3-5\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 100</span>\n<span id=\"cb3-6\"><a href=\"#cb3-6\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">seu</span> codigo de acesso eh banana</span>\n<span id=\"cb3-7\"><a href=\"#cb3-7\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$take</span> 102</span>\n<span id=\"cb3-8\"><a href=\"#cb3-8\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">seu</span> codigo de acesso eh sapoti</span>\n<span id=\"cb3-9\"><a href=\"#cb3-9\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb3-10\"><a href=\"#cb3-10\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Used banana</span>\n<span id=\"cb3-11\"><a href=\"#cb3-11\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Free goiaba</span>\n<span id=\"cb3-12\"><a href=\"#cb3-12\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Used sapoti</span>\n<span id=\"cb3-13\"><a href=\"#cb3-13\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$return</span> 102 sapoti</span>\n<span id=\"cb3-14\"><a href=\"#cb3-14\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb3-15\"><a href=\"#cb3-15\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Used banana</span>\n<span id=\"cb3-16\"><a href=\"#cb3-16\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Free goiaba</span>\n<span id=\"cb3-17\"><a href=\"#cb3-17\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Free sapoti</span>\n<span id=\"cb3-18\"><a href=\"#cb3-18\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"co\">#__case erros</span></span>\n<span id=\"cb3-19\"><a href=\"#cb3-19\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$return</span> 100 acerola</span>\n<span id=\"cb3-20\"><a href=\"#cb3-20\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> codigo de acesso invalido</span>\n<span id=\"cb3-21\"><a href=\"#cb3-21\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$return</span> 102 sapoti</span>\n<span id=\"cb3-22\"><a href=\"#cb3-22\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> locker 102 nao esta em uso</span>\n<span id=\"cb3-23\"><a href=\"#cb3-23\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$return</span> 104 goiaba</span>\n<span id=\"cb3-24\"><a href=\"#cb3-24\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">warning:</span> locker 104 nao existe</span>\n<span id=\"cb3-25\"><a href=\"#cb3-25\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$show</span></span>\n<span id=\"cb3-26\"><a href=\"#cb3-26\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">100</span> Used banana</span>\n<span id=\"cb3-27\"><a href=\"#cb3-27\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">101</span> Free goiaba</span>\n<span id=\"cb3-28\"><a href=\"#cb3-28\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"ex\">102</span> Free sapoti</span>\n<span id=\"cb3-29\"><a href=\"#cb3-29\" aria-hidden=\"true\" tabindex=\"-1\"></a><span class=\"va\">$end</span></span></code></pre></div>\n</body>\n</html>",
    "upload": [
        {
            "name": "vpl_evaluate.cases",
            "contents": ">>>>>>>> INSERT init\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$show\n100 Free banana\n101 Free goiaba\n102 Free sapoti\n$end\n<<<<<<<< FINISH\n\n\n>>>>>>>> INSERT criar ja existindo\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\nshow\ncreate 101 murici\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$show\n100 Free banana\n101 Free goiaba\n102 Free sapoti\n$create 101 murici\nwarning: locker 101 ja existe\n$show\n100 Free banana\n101 Free goiaba\n102 Free sapoti\n$end\n<<<<<<<< FINISH\n\n\n>>>>>>>> INSERT init\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\ntake 101\ntake 102\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$take 101\nseu codigo de acesso eh goiaba\n$take 102\nseu codigo de acesso eh sapoti\n$show\n100 Free banana\n101 Used goiaba\n102 Used sapoti\n$end\n<<<<<<<< FINISH\n\n\n>>>>>>>> INSERT erros de alocacao\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\ntake 101\ntake 102\nshow\ntake 104\ntake 101\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$take 101\nseu codigo de acesso eh goiaba\n$take 102\nseu codigo de acesso eh sapoti\n$show\n100 Free banana\n101 Used goiaba\n102 Used sapoti\n$take 104\nwarning: locker 104 nao existe\n$take 101\nwarning: locker 101 ja esta em uso\n$show\n100 Free banana\n101 Used goiaba\n102 Used sapoti\n$end\n<<<<<<<< FINISH\n\n\n>>>>>>>> INSERT init\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\ntake 100\ntake 102\nshow\nreturn 102 sapoti\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$take 100\nseu codigo de acesso eh banana\n$take 102\nseu codigo de acesso eh sapoti\n$show\n100 Used banana\n101 Free goiaba\n102 Used sapoti\n$return 102 sapoti\n$show\n100 Used banana\n101 Free goiaba\n102 Free sapoti\n$end\n<<<<<<<< FINISH\n\n\n>>>>>>>> INSERT erros\ncreate 100 banana\ncreate 101 goiaba\ncreate 102 sapoti\ntake 100\ntake 102\nshow\nreturn 102 sapoti\nshow\nreturn 100 acerola\nreturn 102 sapoti\nreturn 104 goiaba\nshow\nend\n======== EXPECT\n$create 100 banana\n$create 101 goiaba\n$create 102 sapoti\n$take 100\nseu codigo de acesso eh banana\n$take 102\nseu codigo de acesso eh sapoti\n$show\n100 Used banana\n101 Free goiaba\n102 Used sapoti\n$return 102 sapoti\n$show\n100 Used banana\n101 Free goiaba\n102 Free sapoti\n$return 100 acerola\nwarning: codigo de acesso invalido\n$return 102 sapoti\nwarning: locker 102 nao esta em uso\n$return 104 goiaba\nwarning: locker 104 nao existe\n$show\n100 Used banana\n101 Free goiaba\n102 Free sapoti\n$end\n<<<<<<<< FINISH\n\n",
            "encoding": 0
        }
    ],
    "keep": [],
    "required": [],
    "draft": {
        "hs": [
            {
                "name": "Main.hs",
                "contents": "import qualified Data.Map as Map\nimport qualified Data.Maybe as Maybe\nimport Data.Either\n\ndata State = Used | Free deriving (Show, Eq)\ntype Code = String\ntype Locker = (State, Code)  -- uma \u00fanica porta\ntype Index = Int\ntype Cabinet = Map.Map Index Locker  -- O m\u00f3vel com todas as portas\n\ntype Action = String\ntype Output = String\ntype Error = String\ntype Result = Either Output Error\n\n\n-- Junta um vetor de textos usando \\n\njoin :: [String] -> String\njoin = foldl1 (\\a b -> a ++ \"\\n\" ++ b)\n\n-- permite a composi\u00e7\u00e3o ao contr\u00e1rio\n(&) :: t1 -> (t1 -> t2) -> t2\n(&) x f = f x\n\nemptyCabinet :: Cabinet\nemptyCabinet = Map.empty\n\n-- cria um arm\u00e1rio se ele ainda nao existir\ncreateLocker :: Cabinet -> Index -> Code -> (Cabinet, Result)\ncreateLocker cabinet index code\n    | Map.lookup index cabinet & Maybe.isJust = (cabinet, Right $ \"locker \" ++ show index ++ \" ja existe\")\n    | otherwise = (Map.insert index (Free, code) cabinet, Left \"\")\n\n-- transforma de cabinet para string\nstrCabinet :: Cabinet -> String\nstrCabinet cabinet = Map.assocs cabinet & map showLocker & join\n    where showLocker (index, (state, code)) = show index ++ \" \" ++ show state ++ \" \" ++ code\n\nprocess :: (Cabinet, Result) -> Action -> (Cabinet, Result)\nprocess (cabinet, _) line\n    | cmd == \"show\" = (cabinet, Left $ strCabinet cabinet)\n    | cmd == \"create\" = createLocker cabinet (intArg 1) (args !! 2)\n    | cmd == \"take\" = takeLocker cabinet $ intArg 1\n    | cmd == \"return\" = returnLocker cabinet  (intArg 1) (args !! 2)\n    | otherwise = (cabinet, Right \"comando invalido\")\n    where\n        args = words line\n        cmd = head args\n        intArg index = read (args !! index) :: Int\n\n\nprocessAll :: [Action] -> [String]\nprocessAll action_list = scanl process (emptyCabinet, Left \"\") action_list \n                        & tail                                    -- exclui o primeiro\n                        & fmap snd                                -- pega apenas as mensagens\n                        & zipWith composeMsg action_list          -- junta as mensagens com os comandos\n            where composeMsg action message = case message of\n                        (Left output) -> \"$\" ++ action ++ (if output == \"\" then \"\" else \"\\n\" ++ output)\n                        (Right error) -> \"$\" ++ action ++ \"\\nwarning: \" ++ error\n\nmain :: IO ()\nmain = do\n    action_list <- getContents -- texto com os comandos a serem processados\n    action_list & lines & takeWhile (/=\"end\") & processAll & join & putStrLn\n    putStrLn \"$end\"\n",
                "encoding": 0
            }
        ]
    }
}
